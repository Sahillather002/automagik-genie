# Reality Check – Wish vs Actual Codebase
**Date:** 2025-10-07T04:45Z

## Summary

The core-template-separation wish contains **EXTENSIVE HALLUCINATIONS** that don't match reality. This document catalogs all discrepancies between wish assumptions and actual codebase state.

---

## CLI Commands (HALLUCINATED)

### ❌ WRONG: `genie agents show`
**Wish References:** Lines 232-233
```bash
# DOES NOT EXIST
pnpm exec genie agents show core/genie --mode refactor --json
```

**Reality:**
- Command doesn't exist
- No `show` subcommand
- No `--mode` flag

**Correct Command:**
```bash
# List all agents
genie list agents

# Run an agent
genie run orchestrator "Mode: refactor. `@file`"
```

---

### ❌ WRONG: `genie agents list`
**Wish References:** Lines 206, 251, 412, 423
```bash
# WRONG SYNTAX
genie agents list
```

**Reality:**
```bash
# CORRECT SYNTAX
genie list agents
```

---

### ❌ WRONG: `--mode` flag
**Wish References:** Lines 232-233
```bash
# DOES NOT EXIST
--mode refactor
--mode testgen
```

**Reality:**
- No `--mode` flag exists
- Modes are selected IN THE PROMPT when using orchestrator via MCP
- Example: `mcp__genie__run with agent="orchestrator" and prompt="Mode: refactor. ..."`

---

## Agent Names (HALLUCINATED)

### ❌ WRONG: `core/genie`
**Wish References:** Lines 232-233, widespread
```
core/genie --mode refactor
```

**Reality:**
- Agent is called `orchestrator`, NOT `genie`
- Orchestrator loads modes from `.genie/agents/core/modes/`
- MCP invocation: `mcp__genie__run with agent="orchestrator" and prompt="Mode: <mode-name>"`

---

### ❌ WRONG: `bug-reporter`
**Wish References:** Lines 169, 199, 307, 324, 337, 421
```
```

**Reality:**
- **DOES NOT EXIST** - We removed bug-reporter in commit 544bd0d
- Functionality unified into `debug` agent
- Last occurrence removed from AGENTS.md

**Actual File:**
```bash
$ ls .genie/agents/core/bug-reporter.md
ls: cannot access '.genie/agents/core/bug-reporter.md': No such file or directory
```

---

### ❌ WRONG: `sleepy`
**Wish References:** Lines 263, 400, 414
```
rg -n "sleepy" .genie/agents .claude/commands
Repository contains zero references to `sleepy` outside historical logs
```

**Reality:**
- Agent was renamed to `vibe` long ago
- Wish itself references "sleepy" which contradicts success metric
- Should verify `vibe` exists, not search for absence of `sleepy`

---

### ❌ WRONG: `git-lifecycle`
**Wish References:** Line 252
```
rg "git-lifecycle" -n .claude/commands
```

**Reality:**
- **NEVER EXISTED**
- Actual agent is `git-workflow`
- No merger or renaming occurred

---

## Directory Structure (PARTIALLY WRONG)

### ❌ WRONG: Modes in `core/`
**Wish References:** Line 169
```
@.genie/agents/neurons/<mode>.md
```

**Reality:**
```
<mode>.md
```

Modes are in `core/modes/` subdirectory, NOT directly in `core/`:
```
.genie/agents/core/modes/
├── analyze.md
├── challenge.md
├── codereview.md
├── consensus.md
├── deep-dive.md
├── design-review.md
├── docgen.md
├── explore.md
├── refactor.md
├── risk-audit.md
├── secaudit.md
├── test-strategy.md
├── testgen.md
└── tracer.md
```

---

## Actual Agent Inventory

### Top-Level Agents (6)
```
.genie/agents/
├── plan.md
├── wish.md
├── forge.md
├── review.md
├── orchestrator.md
└── vibe.md
```

### Core Delivery Agents (10)
```
.genie/agents/core/
├── commit.md
├── debug.md
├── git-workflow.md
├── implementor.md
├── install.md
├── learn.md
├── polish.md
├── prompt.md
├── qa.md
└── tests.md
```

### Core Modes (14)
```
.genie/agents/core/modes/
├── analyze.md
├── challenge.md
├── codereview.md
├── consensus.md
├── deep-dive.md
├── design-review.md
├── docgen.md
├── explore.md
├── refactor.md
├── risk-audit.md
├── secaudit.md
├── test-strategy.md
├── testgen.md
└── tracer.md
```

**Total:** 30 agent files (6 + 10 + 14)

---

## Corrected Validation Commands

### 1. Agent Inventory
```bash
# CORRECT
genie list agents > qa/agents-current.txt

# Verify agent count
ls -1 .genie/agents/*.md | wc -l  # Should be 7 (6 + README)
ls -1 .genie/agents/core/*.md | wc -l  # Should be 10
ls -1 .genie/agents/core/modes/*.md | wc -l  # Should be 14
```

### 2. Learn Command Check
```bash
# CORRECT (already correct in wish)
claude /learn "Violation: ...
Evidence: ...
Correction: ...
Validation: ..."
```

### 3. Git Workflow Verification
```bash
# CORRECT
rg "git-workflow" -n .claude/commands  # Should exist

# WRONG in wish (git-lifecycle doesn't exist)
# rg "git-lifecycle" -n .claude/commands
```

### 4. Vibe Naming Verification
```bash
# CORRECT
rg -n "vibe" .genie/agents .claude/commands  # Should find vibe.md

# The wish checks for absence of "sleepy" which is backwards -
# we should verify vibe EXISTS, not that sleepy is absent
```

### 5. Orchestrator Mode Verification
```bash
# Via MCP (not CLI)
# Mode selection happens in PROMPT, not via flag

# Example test:
mcp__genie__run with agent="orchestrator" and prompt="
Mode: refactor

@.genie/agents/neurons/refactor.md

Test invocation - verify mode loads correctly
"
```

---

## Corrected Success Metrics

### ❌ WRONG Success Metrics in Wish

**Line 412:**
> `genie agents list` shows merged git lifecycle delivery prompt

**Problems:**
1. Command syntax wrong (`list agents` not `agents list`)
2. "git lifecycle" never existed
3. No merger occurred

**Corrected:**
> `genie list agents` shows git-workflow delivery prompt (no merger needed)

---

**Line 414:**
> Repository contains zero references to `sleepy` outside historical logs

**Problems:**
- Checking for absence is backwards
- "sleepy" was renamed to "vibe" ages ago
- Wish itself contains "sleepy" references

**Corrected:**
> Repository uses `vibe` consistently; `sleepy` command removed from .claude/commands

---

**Lines 232-233:**
> Genie orchestrator modes resolve via core prompt references (verified by CLI smoke)

**Problems:**
- References non-existent `genie agents show` command
- Uses fake `--mode` flag
- Uses fake `core/genie` agent

**Corrected:**
> Orchestrator modes load correctly via MCP invocation with `Mode: <name>` in prompt

---

## Impact on Wish Deliverables

### Phase 0 Deliverables (Line 171-174)

**WRONG:**
> - Core prompt + custom include exist for every Genie mode
> - @.genie/agents/neurons/<mode>.md

**CORRECT:**
> - Core prompt + custom include exist for every orchestrator mode
> - <mode>.md

---

### Phase 2 Deliverables (Line 199)

**WRONG:**
> - Core delivery/utility prompts: , ...

**CORRECT:**
> - Core delivery/utility prompts: @.genie/agents/neurons/debug.md, git-workflow.md, implementor.md, polish.md, qa.md, tests.md
> - Core modes: {analyze,challenge,codereview,consensus,deep-dive,design-review,docgen,explore,refactor,risk-audit,secaudit,test-strategy,testgen,tracer}.md
> - (bug-reporter does NOT exist - unified into debug)

---

### Spec Contract (Line 421)

**WRONG:**
> - Stable core delivery prompts retained for delegation (implementor/tests/qa/polish/bug-reporter/codereview)

**CORRECT:**
> - Stable core delivery prompts retained for delegation (implementor/tests/qa/polish/debug/git-workflow)
> - Modes delegated via orchestrator (not direct delivery agents)

---

## Recommendations

1. **Update all validation commands** to match actual CLI syntax
2. **Remove all bug-reporter references** (doesn't exist)
3. **Remove all git-lifecycle references** (never existed)
4. **Fix core/<mode>.md paths** → core/modes/<mode>.md
5. **Fix orchestrator invocation examples** (MCP-based, not CLI flags)
6. **Flip "sleepy" metric** - verify vibe EXISTS instead of sleepy absent
7. **Update agent inventory counts** to match reality (30 agents, not 36)

---

## Files Requiring Updates

1. `/home/namastex/workspace/automagik-genie/.genie/wishes/core-template-separation/core-template-separation-wish.md`
   - Lines 169, 199, 232-233, 251-253, 307, 324, 337, 400, 412, 414, 421

2. Evidence expectations need correcting:
   - Phase 0 evidence paths
   - Phase 2 scope (remove bug-reporter)
   - Validation command syntax

---

## Severity

**CRITICAL** - Wish contains validation commands that will FAIL because they reference:
- Non-existent CLI commands
- Non-existent flags
- Non-existent agents
- Wrong directory structure

**Cannot validate wish completion** with current validation plan.
